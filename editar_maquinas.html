<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#fff" />
  <link rel="apple-touch-icon" href="/assets/Icon/180.png">
  <link rel="manifest" href="manifest.json" />
  <title>Insighter - Edição de Máquinas</title>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons"
  rel="stylesheet">
  <link rel="stylesheet" href="assets/css/NavBar.css">
  <link rel="stylesheet" href="assets/css/editar_maquinas_style.css">
  <link href='https://fonts.googleapis.com/css?family=Zen Maru Gothic' rel='stylesheet'>
  <link rel="shortcut icon" href="/assets/Icon/180.png" type="image/x-icon" />
</head>

<body>
  <nav class="navbar">
    <svg width="30" height="30"  fill="none" xmlns="http://www.w3.org/2000/svg">
       <path
          d="M12.936 10.2285C14.655 9.32306 17.4077 9.6346 19.017 11.7498C20.689 13.9475 20.4348 17.059 18.4503 18.8815C16.4329 20.7345 13.4235 20.7059 11.4624 18.7945C9.45127 16.8338 9.45698 13.7917 10.9046 11.8634C10.9604 12.3424 11.1163 12.7448 11.4599 13.0479C11.8034 13.351 12.2084 13.5022 12.6692 13.4458C13.0124 13.4113 13.3352 13.2631 13.5887 13.0236C13.8422 12.7842 14.0125 12.4666 14.0738 12.1191C14.2202 11.3156 13.8709 10.7347 12.936 10.2285ZM14.2424 13.4601C14.1436 13.4599 14.0458 13.4797 13.9546 13.5185C13.8634 13.5572 13.7805 13.6141 13.7109 13.6857C13.6412 13.7574 13.5861 13.8425 13.5488 13.9361C13.5114 14.0297 13.4925 14.13 13.4932 14.2311C13.4932 14.3838 13.5374 14.533 13.6203 14.6599C13.7032 14.7868 13.8211 14.8856 13.9589 14.9438C14.0967 15.0021 14.2483 15.0171 14.3945 14.9871C14.5406 14.957 14.6748 14.8832 14.7799 14.7749C14.8851 14.6667 14.9565 14.529 14.9851 14.3791C15.0138 14.2293 14.9983 14.0742 14.9407 13.9333C14.8832 13.7925 14.786 13.6724 14.6617 13.5881C14.5374 13.5038 14.3914 13.4593 14.2424 13.4601Z"
          fill="#3540E6" />
       <path
          d="M14.2659 13.5C14.4106 13.4995 14.5523 13.543 14.6729 13.6251C14.7935 13.7071 14.8877 13.824 14.9435 13.9609C14.9993 14.0979 15.0142 14.2487 14.9864 14.3943C14.9585 14.5399 14.8891 14.6738 14.787 14.779C14.6849 14.8842 14.5547 14.956 14.4127 14.9852C14.2708 15.0145 14.1236 15 13.9897 14.9435C13.8559 14.887 13.7414 14.7911 13.6607 14.6679C13.5801 14.5446 13.5369 14.3997 13.5366 14.2513C13.5368 14.0527 13.6135 13.8623 13.7502 13.7216C13.8868 13.5808 14.0722 13.5012 14.2659 13.5Z"
          fill="white" />
       <path
          d="M12.4389 13.5C13.4492 13.5 14.2682 12.7445 14.2682 11.8125C14.2682 10.8805 13.4492 10.125 12.4389 10.125C11.4286 10.125 10.6096 10.8805 10.6096 11.8125C10.6096 12.7445 11.4286 13.5 12.4389 13.5Z"
          fill="white" />
       <path
          d="M15.3423 6.75C16.6676 6.76547 18.1918 7.18645 19.5755 8.0703C20.0171 8.35203 20.1299 8.85681 19.8576 9.25007C19.5952 9.63107 19.1274 9.70134 18.6766 9.47119C18.1721 9.21332 17.6702 8.92386 17.1335 8.74915C12.6424 7.2896 8.0968 10.6903 8.31529 15.332C8.48522 18.948 11.7153 21.8013 15.3954 21.5854C20.355 21.2965 23.2786 16.0688 20.8779 11.774C20.687 11.4323 20.6417 11.1061 20.8779 10.7825C20.9585 10.6705 21.0665 10.5802 21.1919 10.52C21.3173 10.4599 21.4562 10.4317 21.5956 10.4381C21.735 10.4445 21.8706 10.4853 21.9897 10.5568C22.1089 10.6282 22.2078 10.728 22.2774 10.8469C23.1257 12.2691 23.5148 13.8125 23.3928 15.4519C23.3404 16.1535 23.2084 16.8472 22.9991 17.52C22.6831 18.5193 22.1674 19.4466 21.4822 20.2476C20.8273 21.0303 20.0307 21.6871 19.1326 22.1849C17.7351 22.9585 16.2215 23.3453 14.6166 23.2299C11.1996 22.9785 8.69452 21.3333 7.32784 18.2466C6.05694 15.3745 6.4388 12.5901 8.31201 10.0527C9.86175 7.95039 12.374 6.75 15.3423 6.75Z"
          fill="#25E6B1" />
       <path
          d="M14.2321 30C8.94702 29.7562 4.33618 27.0411 1.56472 21.5443C-0.364071 17.7201 -0.458716 13.7134 1.00012 9.68201C1.37203 8.67832 1.85362 7.71888 2.43611 6.82118C2.70242 6.40418 3.19849 6.2545 3.55292 6.47934C4.04376 6.79176 4.15734 7.2421 3.85252 7.71792C2.31644 10.118 1.6065 12.7422 1.72268 15.5906C1.79187 17.2658 2.15479 18.8795 2.86299 20.3985C4.87337 24.7123 8.24077 27.3313 12.9064 28.134C16.6309 28.7738 20.0537 27.8823 23.0935 25.5973C24.0266 24.8988 24.8567 24.0722 25.5595 23.1417C25.6985 22.9611 25.9035 22.843 26.1294 22.8135C26.3553 22.784 26.5836 22.8454 26.7644 22.9842C27.1364 23.277 27.1789 23.7979 26.8558 24.2117C25.5692 25.8696 23.9478 27.2371 22.0974 28.2248C19.8984 29.4013 17.5466 29.9817 14.2321 30Z"
          fill="#25E6B1" />
       <path
          d="M15.0269 3.37565C16.4619 3.37565 17.8586 3.606 19.199 4.12186C19.7096 4.31652 20.2069 4.55206 20.697 4.79474C21.1871 5.03742 21.3407 5.50851 21.1235 5.93936C20.8977 6.38774 20.3877 6.53568 19.9175 6.27418C18.2944 5.3716 16.5434 4.9933 14.6898 5.04132C10.2468 5.15422 6.30045 8.27078 5.29781 12.5157C4.47199 16.0158 5.34218 19.0979 7.84481 21.7298C8.06732 21.964 8.22759 22.2106 8.16666 22.5428C8.10905 22.8575 7.93223 23.0853 7.61832 23.1917C7.30442 23.2981 7.00177 23.2663 6.77661 23.034C6.39957 22.6554 6.04701 22.254 5.72099 21.8323C5.35683 21.3431 5.02035 20.8347 4.71305 20.3094C4.11675 19.2909 3.70725 18.1779 3.50313 17.0209C2.92035 13.8038 3.53823 10.8202 5.49914 8.17604C7.77329 5.1088 10.8958 3.521 14.7706 3.37824C14.8547 3.37305 14.9428 3.37565 15.0269 3.37565Z"
          fill="#25E6B1" />
       <path
          d="M29.9975 14.7289C30.0201 15.9618 29.8893 17.1927 29.6082 18.393C29.4733 18.9739 28.9983 19.2532 28.4929 19.0685C28.0737 18.9151 27.8713 18.519 27.9842 18.034C28.2575 16.884 28.3711 15.7014 28.3216 14.5201C28.1433 10.6541 26.6052 7.44534 23.707 4.89383C21.6606 3.09312 19.2553 2.07626 16.562 1.7447C16.1111 1.68923 15.6536 1.68466 15.1994 1.67291C14.6272 1.65855 14.2638 1.33613 14.2684 0.82444C14.2729 0.312747 14.6388 -0.00706096 15.2163 0.000118402C18.1899 0.0360152 20.9261 0.860989 23.3917 2.54161C26.5515 4.69542 28.5993 7.64027 29.5557 11.3527C29.8352 12.4565 29.9835 13.5899 29.9975 14.7289Z"
          fill="#25E6B1" />
       <path
          d="M26.7073 14.9338C26.7073 17.4479 25.8835 19.8934 24.3607 21.8991C22.8379 23.9049 20.6994 25.3615 18.2696 26.0478C18.0319 26.113 17.7923 26.1743 17.5493 26.2251C17.0373 26.3326 16.5973 26.0837 16.4905 25.6346C16.3727 25.1406 16.6451 24.7182 17.1781 24.5989C19.5746 24.0625 21.5652 22.8581 23.0057 20.8793C25.232 17.827 25.6177 14.5148 24.2066 11.0069C24.003 10.5005 24.1529 10.0241 24.6054 9.82462C25.0579 9.62517 25.5254 9.8357 25.7447 10.335C26.3785 11.7862 26.7061 13.3515 26.7073 14.9338Z"
          fill="#25E6B1" />
    </svg>
    <div class="tabs">
      <input id="tab-1" type="radio" name="group" />
      <input id="tab-2" type="radio" name="group" />
      <input id="tab-3" type="radio" name="group" />
      <input id="tab-4" type="radio" name="group" />

      <div class="buttons">
        <a href="home.html" class="material-icons">home</a>
        <a href="lista_de_maquinas.html"class="material-icons" >engineering</a>
        <a href="perfil.html" class="material-icons" >account_circle</a>
        <a href="ajuda.html"class="material-icons" >help</a>
      </div>
  </nav>
 
  <div class="titulo_pagina">
    <!--Icone Lapis em SVG-->
    <svg width="25" height="25" viewBox="0 0 25 25" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path
        d="M7.67665 23.2607L20.1769 10.7605L14.2395 4.82306L1.73925 17.3233C1.56716 17.4957 1.44492 17.7113 1.38548 17.9475L0 25L7.05117 23.6145C7.28791 23.5553 7.50448 23.4329 7.67665 23.2607ZM24.2123 6.72507C24.7167 6.22057 25 5.53642 25 4.82306C25 4.1097 24.7167 3.42554 24.2123 2.92105L22.079 0.787671C21.5745 0.283326 20.8903 0 20.1769 0C19.4636 0 18.7794 0.283326 18.2749 0.787671L16.1416 2.92105L22.079 8.85845L24.2123 6.72507Z"
        fill="#3540E6" />
    </svg>
    <h1>Editar Máquina</h1>
  </div>
  </div>
  <div class="mid">
    <form action="">
      <div class="conteudo_forms">
        <div class="nome_maquina">
          <h3>
            Nome da Máquina:
          </h3>
          <input type="text" placeholder="ex: injetora" name="nome_maquina" id="machineName">
        </div>
        <h2>
          Limites dos Sensores:
        </h2>
        <div class="sensor_temperatura">
          <h3>
            Sensor de Temperatura:
          </h3>
          <div class="inputs">
            <div class="min">
              <h3>
                Min:
              </h3>
              <input type="number" min="1" max="999" step="1" placeholder="0" name="min_temperatura" id="tempMin">
            </div>
            <div class="max">
              <h3>
                Max:
              </h3>
              <input type="number" min="1" max="999" step="1" placeholder="0" name="max_temperatura" id="tempMax">
            </div>
          </div>
        </div>
        <div class="sensor_vibracao">
          <h3>
            Sensor de Vibração:
          </h3>
          <div class="inputs">
            <div class="min">
              <h3>
                Min:
              </h3>
              <input type="number" min="1" max="999" step="1" placeholder="0" name="min_vibracao" id="vibMin">
            </div>
            <div class="max">
              <h3>
                Max:
              </h3>
              <input type="number" min="1" max="999" step="1" placeholder="0" name="max_vibracao" id="vibMax">
            </div>
          </div>
        </div>
        <div class="sensor_ruido">
          <h3>
            Sensor de Ruído:
          </h3>
          <div class="inputs_ruido">
            <div class="min">
              <h3>
                Min:
              </h3>
              <input type="number" min="1" max="999" step="1" placeholder="0" name="min_ruido" id="noiseMin">
            </div>
            <div class="max">
              <h3>
                Max:
              </h3>
              <input type="number" min="1" max="999" step="1" placeholder="0" name="max_ruido" id="noiseMax">
            </div>
          </div>
        </div>
        <div class="botoes">
          <button class="btn_cadastrar" type="button" onclick="updateData()">
            Salvar Alterações
          </button>
          <button class="btn_cancelar" type="button" onclick="goBack()">
            Cancelar
          </button>
        </div>
      </div>
    </form>
  </div>
  </div>

  <script>
    function goBack() {
      window.location.replace("lista_de_maquinas.html");
    }
    function getSingleData(id) {
      fetch(`https://retoolapi.dev/2PlLEF/data/${id}`)
        .then(response => {
          if (!response.ok) {
            throw Error("OOPS, SOMETHING WENT WRONG. :(");
          }
          return response.json();
        }).then(data => {
          // TODO add the other inputs
          document.getElementById("machineName").value = data.machineName;
          document.getElementById("tempMin").value = data.tempMin;
          document.getElementById("tempMax").value = data.tempMax;
          document.getElementById("vibMin").value = data.vibMin;
          document.getElementById("vibMax").value = data.vibMax;
          document.getElementById("noiseMin").value = data.noiseMin;
          document.getElementById("noiseMax").value = data.noiseMax;
        }).catch(error => {
          console.log(error);
        })
    };
    function init() {
      const url = new URL(window.location.href);
      const machineId = url.searchParams.get("machineId");
      getSingleData(machineId);
      return machineId;
    }
    var machineId = init();
    function updateData() {
      fetch(`https://retoolapi.dev/2PlLEF/data/${machineId}`, {
        method: 'PATCH',
        headers: {
          'content-type': 'application/json'
        },
        body: JSON.stringify({
          machineName: document.getElementById('machineName').value,
          tempMin: parseInt(document.getElementById('tempMin').value),
          tempMax: parseInt(document.getElementById('tempMax').value),
          noiseMin: parseInt(document.getElementById('noiseMin').value),
          noiseMax: parseInt(document.getElementById('noiseMax').value),
          vibMin: parseInt(document.getElementById('vibMin').value),
          vibMax: parseInt(document.getElementById('vibMax').value)
        })
      }).then(response => {
        if (!response.ok) {
          throw Error("OOPS, SOMETHING WENT WRONG. PATCH FAILED. :(");
        }
        window.location.replace("lista_de_maquinas.html");
        return response.json();
      }).catch(error => {
        console.log(error);
      })
    }
//     function init() {
//     const url = new URL(window.location.href);
//     const machineId = url.searchParams.get("machineId");
//     console.log(machineId);
//     //updateData(machineId);
// }

  </script>
  <script>
    const toggleMenuOpen = () => {
      document.body.classList.toggle("open");
    }
  </script>


  <script typr="module">
    import 'https://cdn.jsdelivr.net/npm/@pwabuilder/pwaupdate';

    const el = document.createElement('pwa-update');
    document.body.appendChild(el);

  </script>

  <script>
    let newWorker;

    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('./service-worker.js').then(reg => {
        reg.addEventListener('updatefound', () => {
          // A wild service worker has appeared in reg.installing!
          newWorker = reg.installing;
          newWorker.addEventListener('statechange', () => {

          });
        });
      });
      let refreshing;
      navigator.serviceWorker.addEventListener('controllerchange', function () {
        if (refreshing) return;
        window.location.reload();
        refreshing = true;
      });
    }
  </script>


</body>

</html>